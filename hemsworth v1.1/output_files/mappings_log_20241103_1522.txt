DELTA LAKE MAPPINGS LOG
Generated: November 3, 2024 10:22 AM
Source: SQL Query Migration

=== TABLE MAPPINGS ===
fdg.fact_sb_gameplay -> core_views.sportsbook.bet_legs
fdg.fact_sb_gameplay_retail -> core_views.sportsbook_retail.gameplay_legs  
fdg.fact_sb_gameplay_can -> core_views.sportsbook_can.bet_legs

=== COLUMN MAPPINGS ===
fdg.fact_sb_gameplay.bet_settled_date_local -> core_views.sportsbook.bet_legs.bet_last_settled_local_ts
fdg.fact_sb_gameplay.bet_settled_date -> core_views.sportsbook.bet_legs.bet_last_settled_ts
fdg.fact_sb_gameplay.dw_date -> [MISSING MAPPING - PLACEHOLDER NEEDED]

fdg.fact_sb_gameplay_retail.bet_settled_date_local -> core_views.sportsbook_retail.gameplay_legs.bet_settled_date_local
fdg.fact_sb_gameplay_retail.bet_settled_date -> core_views.sportsbook_retail.gameplay_legs.bet_settled_ts
fdg.fact_sb_gameplay_retail.dw_date -> [MISSING MAPPING - PLACEHOLDER NEEDED]

fdg.fact_sb_gameplay_can.bet_settled_date_local -> core_views.sportsbook_can.bet_legs.bet_last_settled_local_ts
fdg.fact_sb_gameplay_can.bet_settled_date -> core_views.sportsbook_can.bet_legs.bet_last_settled_ts
fdg.fact_sb_gameplay_can.dw_date -> [MISSING MAPPING - PLACEHOLDER NEEDED]

=== NOTES ===
- dw_date column not found in any of the source tables
- Will need placeholders for missing dw_date mappings in migrated queries
- Temporary table syntax (#table_name) needs to be converted to Databricks format
- TRUNC(SYSDATE - 3) needs to be converted to Databricks date functions
- DATE_TRUNC with timezone conversion needs Databricks equivalent
